\section{\glsentrylong{plc}}
En \gls{plc} kan betegnes som en digital computer, designet til at håndtere multiple analog/digitale \gls{io}. \gls{plc}'en anvendes ofte til elektromekaniske anlæg, hvor de samme handlinger skal udføres sekventielt, med en lav fejlrate, og med en høj sekventiel udførselshastighed. \gls{plc}'en er et reeltids-system, hvoraf outputs' tilstande er et direkte resultat af indgangenes tilstand. I nedenstående afsnit vil \gls{plc}'ens hardware og software blive fremført, med formålet; at kunne synliggøre \gls{plc}'ens fordele og ulemper. Ulemperne vil afslutningsvist blive opsummeret i problembeskrivelsen, som kan læses i kapitel \ref{sec:problembeskrivelse}. \cite{PLC_hardware_desc}

\subsection{Hardware}
\label{subsec:pa-hardware}
Den største forskel mellem hardwaren på en \gls{plc} og andre digitale computere, er at \gls{plc}'er har en konstruktion, som egner sig specifikt til belastende arbejdsmiljøer. \gls{plc}'en er dermed ekstra beskyttet imod støv, temperatursvigninger og luftfugtighed. Figur \ref{fig:omron-plc} viser en af Omrons mest populære \gls{plc}'er, \enquote*{SYSMAC CP1H}. \gls{plc}'en har 24 indgange og 17 udgange (markeret på figur \ref{fig:omron-plc}), hvor COM-porten på indgangsmodulet, giver mulighed for at bestemme den \textit{fælles logik}\fn{Fælles logik}{Spændingspotentiale mellem indgang og den tilhørende COM-port\cite{PLC_NPN_PNP}}. Hertil kan der tilsluttes DC 24V (positiv logik) eller DC 0V (negativ logik), afhængig af kundens præferencer. I Europa anvendes DC 0V som fælles logik, modsat i USA - hvor der anvendes DC 24V. 

\figur{Figurer/Billeder/plc-omron-hardware.jpg}{\gls{plc} Omron SYSMAC CP1H}{omron-plc}{0.8}

\noindent \gls{plc}'ers mekaniske konstruktion er meget varierende fra producent til producent, og fra model til model. Nogle producenter har adskillige modeller, som hver især er blevet konstrueret til et specifikt arbejdsmæssigt formål. Nogle modeller er således konstrueret med udvidelsesmoduler, hvor andre - mere simple \gls{plc}'er - er konstrueret med få indgange/udgange. 
Den store konstruktionsmæssige variation mellem \gls{plc}-fabrikanterne begrænser den enkelte virksomheds fleksibilitet. Der er således ikke mulighed for at sammenkoble et udvidelsesmodul af producenten, Omron, på en \gls{plc} produceret af Allen Bradly\cite{PLC-comb}. På figur \ref{fig:omron-plc} kan der ses en låge, som er markeret med EXP \enquote*{Udvidelsesmodul}, hvilket giver mulighed for at udvide \gls{plc}'en med flere moduler. 

I dag bliver de fleste automatiserede anlæg konstrueret med en \gls{plc}. Det giver den pågældende virksomhed mulighed for at konstruere et anlæg, hvor der skal færre tilpasninger til, før anlægget kan benyttes i flere forskellige arbejdsmiljøer. Det medvirker ligeledes til forøget fleksibilitet ved slutkunden, da reguleringer kan foretages hurtigt og uden større mekaniske indgreb.\\

\noindent For at give en bedre forståelse for \gls{plc}'en, vil nedenstående afsnit korfattet introducere tre \gls{plc}-producenter. Indledningsvist vil Siemens blive introduceret, som er en af de største \gls{plc}-producenter på markedet. Omron er på lige fod med Siemens et udbredt fabrikat, som benyttes i rigtig mange automatiserede anlæg. Omron's \gls{plc}-model, \enquote*{SYSMAC CP1H}, er samtidig tilgængelig for gruppen. CODESYS er de ledende udviklere af softwareapplikation til controller-systemets, og har udviklet CODESYS SP6, som bygger på det objekt-orienteret programmeringsparadigme.

\subsubsection*{PLC-producenter}
\label{subsec:siemens}
\noindent\textbf{Siemens} er klart de største på \gls{plc} markedet \cite{plc-marked-shares}, og igennem fire generationer af \gls{plc}'er, er Siemens én af de mest kompetente \gls{plc}-producenter på markedet - både på det hardware- såvel som det softwaremæssige plan. Den fjerde generation, \enquote*{Simatic S7} som er Siemens seneste udgave, bliver anvendt i mange aspekter af industrien. Specielt Siemens' evne til at konstruere \gls{plc}'er med høj ydeevne, og til en lav pris, er Siemens forcé. I året 2012, lancerede Siemens et nyt IDE, som til stadighed benytter sig af den traditionelle \gls{lad} programmeringssprog. De har trods den massive softwaremæssige udvikling, med implementationen af det objekt-orienterede programmeringsparadigme (se afsnit \ref{subsec:codesys} og \ref{subsec:software_codesys}), valgt at holde fast i det funktionelle programmeringsparadigme. \\

\noindent\textbf{Omron} har eksisteret siden 1972, hvor Omron begyndte at producere små enheder til f.eks. lommeregnere. Nogle af disse komponenter blev blandt andet distribueret til Harvard University. Det var først i året 1977, da Omron påbegyndte deres \gls{plc}-standardlinje, kaldet \enquote*{SYSMAC PLC}, at \gls{plc}'en blev deres førende produktionsserie. I dag har Omron ca. 6\% af markedet på \gls{plc}'er i Kina og opererer i mere end 80 lande i Europa, Nordamerika og Asien\cite{plc-marked-shares}. Omron benytter sig stadig af \gls{lad}.\\

\label{subsec:codesys}
\noindent\textbf{CODESYS} er udviklet af det Tyske softwarefirma, 3S-Smart Software Solutions, som i år 1994 var klar med første udgave af CODESYS. Det som gør CODESYS unik, er at de har implementeret et objektorienteret programmeringssprog i version 3, som giver mulighed for at adskille forskellige arbejdsopgaver, og dermed muligheden for at outsource dele af programmet. Konkrete eksempler på hvordan CODESYS har implementeret \gls{oop} i PLC-universet kan læses i afsnit \ref{subsec:software_codesys}.\sfix{Jeg skal skrive noget omkring fordele ved OOP} \\

\noindent \gls{plc}'ens hardware og de førende \gls{plc}-producenter er nu blevet gennemgået; hvor det blev belyst at \gls{plc} mekaniske konstruktion er modstanddygtige overfor hårde arbejdsmiljøer. Ydermere blev der fremført, at de fleste \gls{plc}-producenter, som f.eks. Siemens og Omron, stadig kun understøtter det funktionelle programmeringsparadigme. 
Hvordan \gls{plc}-programmering har udviklet sig igennem årene, samt \gls{lad}'s fordele og ulemper, vil det næste afsnit belyses nærmere.

\subsection{Software}
%% PDF TIL PLC-GENNEMGANG: 
%% http://www.etf.unssa.rs.ba/~slubura/Procesni%20racunari/Programmable%20Logic%20Controllers%204th%20Edition%20%28W%20Bolton%29.pdf
Programmeringsprog til \gls{plc}'en har ikke udviklet sig meget siden indtoget i 1960'erne. 
Mange af \gls{plc}-producenterne holder fast i den oprindelige opfattelse; at \gls{plc}'er hovedsagligt anvendes til mindre programmeringsopgaver (Se \ref{ subsec:siemens}). De mest udbredte \gls{plc}'er til dato, programmeres stadig i det funktionelle paradigme. Programmeringssproget er primitivt, og det er meget besværligt at være produktiv – især ved større projekter. Dette skyldes blandt andet, at flere \gls{plc}-programmører ikke benytter sig af subrutiner, og ved større projekter kan programmøren miste overblikket. 

I år 1993 blev det første udkast til \gls{iec} 1131-3 standarden publiceret\cite{iecStandard}. Standarden havde til formål at sikre en generalisering af hvordan software til \gls{plc}'er skrives og forstås. Igennem årene er det blevet mere og mere normalt, at både slutkunden, leverandøren og \gls{plc}-producenten følger, og efterspørger denne standard. Mange slutkunder, står selvstændigt for vedligeholdelsen og reprogrammering af deres automatiserede anlæg, og har ikke den fornødne kapacitet til at få indopereret en ny standard i deres travle arbejdsmiljø. \\

\noindent Flere softwarefirmaer har forsøgt at implementere det objektorienterede paradigme i \gls{plc}'en. For mange industriteknikere, som også fungerer som \gls{plc}-programmører i industrien, kan \gls{oop} dog blive for omstændigt. For at kunne programmere et funktionelt program i det \gls{oop} paradigme, kræver den anderledes abstrakt tænkegang, som for mange; kan forekomme meget uoverskuelig i begyndelsen. Det kræver således, at den enkelte programmør, er villig til give slip på gamle vaner og notationer - hvilket kan være en tidskrævende proces.
Mange \gls{plc}-programmører holder derfor fast i de gamle og velkendte programmeringsrutiner. Dette kan i visse tilfælde, som tidligere nævnt, ligeledes skyldes arbejdspladsens konservative indgangsvinkel\cite{PLC_Siemens_OOP}.  \\

\noindent \gls{iec} 1131-3 standarden definerer fem forskellige programmeringssprog til en \gls{plc}. To grafiske (\gls{lad} og \gls{fbd}) og tre tekstrepræsenterede (\gls{il}, \gls{sfc} og \gls{st}) sprog. Alle sprog deler de samme egenskaber og funktioner, hvilket gør det nemt at oversætte fra det ene sprog til det andet. Ligeledes giver det programmører mulighed for at manøvrere frit mellem alle sprog. Udfra egne programmeringspræferencer, kan programmøren dermed vælge det sprog, som bedst kan løse den pågældende opgave.

\subsubsection{Ladder Diagrams}
\gls{lad} er et grafisk programmeringssprog, der har fået navnet fra dens grafiske repræsentation, som ligner en stige. Funktionerne er opbygget i \textit{sekventielle trin}\fn{Sekventielle trin}{Ved initialisering udføres programmet henholdsvist fra top mod bund}, hvorved den almene PLC-programmeringskonsensus, er at navngive funktionerne: "Trin \textit{n: <Funktionsnavn>}". 
\gls{lad} programmeres ved hjælp af logiske \textit{AND}, \textit{OR}, \textit{NOT}, \textit{NAND}, \textit{NOR}, \textit{XOR}-blokke, i et \gls{ide} som den enkelte \gls{plc}-producent har stillet til rådighed. I \gls{ide}'et kan man ved hjælp af Drag \& Drop-funktionalitet indsætte kontaktsæt, timere og andre kontaktelementer. På figur \ref{fig:Ladder} ses et simpelt \gls{lad}-program. \textit{AND}, \textit{OR} og \textit{COIL}-symboler som repræsenterer en ind og ud-gange på \gls{plc}'en. Første linje viser, at udgangen Q10.00 aktiveres, såfremt indgangene \textit{( ( 000.01 \&\& 000.04) || 000.00 ) \&\& 000.02 )} er aktive.

\figur{Figurer/Billeder/Ladder.png}{Grafisk repræsentation af ladder programmering}{Ladder}{0.4}

\noindent \gls{lad} egner sig til simple programmer, hvor der kun anvendes binære variabler. Da eksekveringen af programmet sker trinvis sekventielt, kan der dermed opstå periodiske \textit{race conditions\fn{Race Condition}{Udtrykker at outputs er afhængig af en specifik hændelsesrækkefølge eller timing}}, som kan være meget besværlige at fejlfinde. Aritmetiske operationer og analoge input kan være besværlige at udtrykke; hvoraf notationen kan variere på tværs af producenterne. Ydermere er iterative kontrolstrukturer ikke understøttet i form af \textit{For}, \textit{While} eller \textit{Do While}-loops. \gls{lad}-programmering anvender istedet \textit{countere}-funktionsblokke, som kan konfigureres til at tælle én op ved hver iteration. Det er således ikke muligt at sende aktuelle parametre med til en funktion. Det kan i visse tilfælde medvirke til at programmøren er nødsaget til at implementere identiske funktioner, hvorved den eneste forskel er counterens \textit{preset}-værdi\fn{Preset-værdi}{Et udtryk for hvornår (counter-værdi) den aktuelle counter skal ændre status til høj}. \\

\noindent \gls{lad} er den mest populære måde at konstruere og repræsentere et \gls{plc}-program på. Lærbarheden er høj, og det er nemt - såfremt programmet er småt - at gennemskue \gls{plc}-sprogets opbygning. Mange automatiserings-leverandører vælger at vedlægge et \gls{lad}-repræsenteret diagram, som slutkunden kan bruge i tilfælde af nedbrud, regulering eller udbyggelse. \cite{FDB_desc}

\subsubsection{Function Block Diagram}
%\gls{fbd} er den anden grafiske måde at repræsentere et \gls{plc}-program. \gls{fbd} er programmeret ved hjælp af de samme logiske blokke som omtalt i \gls{lad}. Ligeledes kan på samme måde bruge mere avancerede blokke som timere og tællere. På figur \ref{fig:FBD} ses et eksempel på Et simpelt Function Block Diagram.
\gls{fbd} er den anden grafiske programmeringsrepræsentation, og er PLC-programmeringssprogets nærmeste svar på kodegenbrug. FBD anvendes til at afbilde konkrete dataflows eller signaler igennem en funktionsblok - hvoraf det er muligt at konstruere kontrolblokke, som kan genanvendes i flere forskellige softwaremæssige sammenhænge. FBD giver programmøren mulighed for at opbygge kodeblokke, hvilket potentielt kunne repræsentere én motor. Hertil skal motoren have \textit{n}-antal inputs for at starte, hvortil outputs oftest repræsenteres i HEX-kode - som er almen koderepræsentation på frekvensomformere\fn{Frekvensomformer}{Anvendes til at regulere motorer; deres eksponentielle startid, spin-hastighed m.v.}. Et simpelt FBD-diagram kan ses på figur \ref{fig:FBD}.

\figur{Figurer/Billeder/FBD.jpg}{Grafisk repræsentation af et \gls{fbd}}{FBD}{0.4}

\noindent \gls{fbd} er en repræsentation, som de erfarne \gls{plc}-programmører anvender. \gls{fbd} kan fungere som et bibliotek, som kan importeres i konkrete implementationer, og dermed give den ønskede funktionalitet til projektet. \cite{FDB_desc}

\subsubsection{Instruction List}
\gls{il} beskrives nemmest som et tekstrepræsenteret LAD-programmeringssprog. IL består af en række instruktioner; én instruks pr. linje. En instruks kan bestå af én eller flere operander. Ulempen ved IL er, at \gls{plc}-producenterne ikke vælger at følge konventionen (jf. \gls{iec} 1131-3), hvorved notationen skifter på tværs af producenterne. Figur \ref{fig:plc-il} viser et simpelt eksempel på et \gls{il}-repræsenteret program. \textit{LD} udtrykker operatoren, og instruerer at \textit{A} skal indlæses i \gls{mar}\fn{\gls{mar}}{Holder hukommelsesplaceringen af dét data som ønskes tilgået}. Det kan dermed blive kaldt af andre operationer. Den næste linje, har det boolske udtryk, \textit{ANDN}, som definerer at \textit{B} ikke skal registreres. \textit{ST} er et udtryk for at resultatet skal indlæses i \textit{C}. Programmøren skal være opmærksom på - som det også blev nævnt tidligere - at \gls{plc}-producenterne har valgt deres egne notationer. Hertil kan det nævnes, at OMRON benævner operatoren \textit{ST} som \textit{OUT}, hvor Siemens eksempelvis har valgt \textit{AN} som deres notation for \textit{ANDN}. \cite{FDB_desc}

\figur{Figurer/Billeder/plc-il.png}{Simpel illustration af et \gls{il}-repræsenteret \gls{plc}-program}{plc-il}{0.3}

\subsubsection{Objektorienteret Programmering}
\label{subsec:software_codesys}

CODESYS blev tidligere gennemgået (se afsnit \ref{subsec:codesys}), hvor det blev belyst at CODESYS har forsøgt at implementere \gls{oop}-programmeringsparadigmet i \gls{plc}-universet. Figur \ref{fig:plc-codesys-sample} viser CODESYS's IDE, hvor det både et muligt at kode i \gls{lad}-programmering, og samtidig få skrevet det tilhørende kode i \gls{oop}. Det giver dermed programmøren mulighed for at afgøre, om hvorvidt han ønsker at benytte \gls{oop} eller \gls{lad}. Vinduerne opdateres i realtime, hvorved det er muligt at se kodeeksempler, udfra den logik der bliver sammensat i \gls{lad}-vinduet. 

\figur{Figurer/Billeder/codesys_sample.png}{Screendump af CODESYS's IDE (Viser henholdsvist \gls{oop} og \gls{lad} i samme IDE)}{plc-codesys-sample}{1}

\noindent CODESYS beskriver deres \gls{oop}-implementation med følgende fordele\cite{codesys-oop-benefits}:
\begin{itemize}
\item Eksisterende programmer kan nemmere blive ændret, eller udbygget - samtidig med at de er nemmere at vedligeholde
\item Kodegenbrug er muligt, hvorved indkapsling er blevet forbedret radikalt
\item Performance er blevet forbedret, dog ikke for mindre programmer
\end{itemize}

\noindent\gls{oop}-programmeringsparadigmet kan - såfremt at programmøren besidder den nødvendige programmeringserfaring - medvirke til et velstruktureret program. Foruden CODESYS, er der også en række andre producenter, som har forsøgt at implementere \gls{oop} - her kan der bl.a. nævnes Beckhoff, som har en kraftig tilvækst igennem det sidste årti. I året 1999 omsatte Beckhoff for \$50 millioner, som i året 2010 er steget til \$346 millioner. Dette indikerer at flere vælger at migrere over til \gls{oop}, fremfor det traditionelle \gls{lad}, og \gls{oop} kan dermed anses for at være i et gunstigt indtog i det mangfoldige \gls{plc}-univers\cite{beckhoff-sold}.



















%\subsubsection{Opsummering}

%% PROS
%\noindent Efter eksempler for hvordan en \gls{plc} kan programmeres ved hjælp af den tidligere omtalte \gls{iec}-standard. Fælles for dem alle, er at de benytter de samme komponenter. Det er en fordel, da man kan benytte forskellige sprog til samme program. Ligeledes kan den enkelte programmør vælge det sprog, de mener passer bedst til dem. \gls{lad} henvender sig specielt til elektrikere, da symbolikken ligner mekaniske kontaktorer og spoler. \gls{fbd} henvender sig til elektronikteknikere, da symbolikken minder meget om logiske AND og OR gates.

%%CONS
%Fælles for alle de omtalte sprog, er at de som tidligere nævnt, benytter sig af de samme objekter. Det sætter en række begrænsninger i hvordan man kan designe sin kodearkitektur. Ved store systemer opdeler man ofte programmet i forskellige abstraktioner. Ligeledes indkapsler man forskellige dele, for at øge læsbarheden samt bidrage til simpliciteten. Disse udfordringer er specielt gældende for overstående \gls{iec} standard, da sproget er designet fra et perspektiv om at forskellige typer programmører skal kunne skrive \gls{plc}-kode. Disse typer kunne eksempelvis være elektrikere, elektronikteknikere og computerprogrammører.


%\subsection{Siemens}
%Siemens er klart de største på PLC markedet, og med fire generationer af PLC´er har Siemens erfaring med produceringen af softwaren og hardware til PLC´en.

%Den fjerde generation Sematic 7 som er den nuværende, bliver brugt i mange aspekter i industrien, heriblandt specielt automatisering af handlinger på fabrikker.
%Dette kunne f.eks. være en slagter, som laver flere tons hakket kød. Her har man før i tiden, skulle have en medarbejder, til at finde ud af hvornår der skulle mere kød i maskinen, hvor man nu har en PLC til med tilhørende sensorer som styrer hvornår der kan komme mere kød i.
%Siemens benytter hertil 3 forskellige programmeringssprogs, hvor det ene er  Ladderprogramming som indeholder en editor, compiler samt en debugger. 
%Editoren gør det muligt at skrive eller ændre i filer herunder kan man også benytte blokke. blokke kan man betegne lidt som en slags modul, hvor man let kan indsætte flere funktioner med en enkelt blok eller flere blokke.
%Dernæst bruger man dets kompiler, som kompilere koden, sammen med blokkene som man har brugt.
%Dette bliver dernæst omdannet til maskinkode som dernæst bliver kørt igennem debuggeren.
%Debuggeren kigger maskinkoden igennem efter logiske fejl, som kunne være opstået. 
%Til får man en compileret udgave af programmet som er tjekket for logiske fejl, som dernæst kan overføres til PLC´en.

%Ideen med denne type af programmeringssprog, er at det skulle være let, for en ikke programmør at komme i gang med programmering, uden yderligere oplæring. Dermed er ideen om drag-and-drop kodning, ganske simpel for en medarbejder at komme i gang med.

% \subsubsection{Interface for Ladderprogrammering}
% Interfacet til Ladderprogrammering på Siemens PLC´er, er meget simpelt og er opbygget som vist på Figur \ref{fig:SiemensLadder}.

% \figur{Figurer/SiemensLadder.png}{Siemens programmerings interfacel}{SiemensLadder}{1}

% \noindent Programmet har en menu i venstre side, hvor programmøren kan vælge kodeblocke og indsætte direkte i koden som et modul.
% Programmøren har ligeledes mulighed for finde instruktioner som f.eks. hvordan man inverter en værdi, eller simpelt bit logik, i venstre side af programmet.
% I højre side af programmet har man sit hovedvindue, hvor alt det grafiske bliver repræsenteret.

% \subsection{Omron}
% Omron har eksisteret siden 1972, hvor Omron begyndte at producere små enheder til f.eks. lommeregnere. Nogle af disse komponenter som blandt andet blev leveret til Harvard University, blev betegnet for at være en form for PLC, dog blev den aldrig masseproduceret, og blev derfor kun specielt produceret.
% Det var først i 1977 hvor Omron producerede deres standardlinje af PLC´er kaldet SYSMAC PLC, som blev masseproduceret. Her blev Omrons tidligere erfaringer med små enheder - microcontrollere samlet til at konstruere en PLC, som var starten på Omrons PLC marked.
% Næsten 10 år efter producerede Omron C200H PLC, som bliver brugt endnu den dag, i dag. Dog havde Omron svært ved at sælge den, mest af alt pga. at Siemens havde 4 år forinden lanceret deres Simatic S5, som var banebrydende på det givende tidspunkt.
% I dag har omron ca. 40 procent af markede på PLCér i Japan og operere i mere end 80 lande, herunder i Europa, Nord America, Kina og Asien.
% \mefix{indsæt http://www.omron.com/about/corporate/business/domain/iab/index.html}

% \subsection{CODESYS}
% CODESYS er udviklet af det Tyske softwarefirma 3S-Smart Software Solutions som i 1994 var klar med første udgave af CODESYS V 1.0 hvilket var tiden hvor automatisering af handlinger virkelig begynde at blive udnyttet.

% I modsætning til flere af CODESYS’ konkurrenter valgte de at udgive deres produkt med en gratis licens. Dette gjorde at de blev meget attraktive på marked, da man ikke længere skulle investere store midler i licenser, når man kunne få det gratis med produktet.
% Det som gør CODESYS’en speciel er at de har implementeret et objektorienteret  programmeringssprog i version 3, som gør at man lettere kan adskille forskellige arbejdsopgaver, og dermed muligheden for at outsource dele af programmet.
% Den objektorienteret tilgang introducere metoder, interfaces, klasser og polymorfi samt try/catch.

% Dette er dog først blevet implementeret i CODESYS V3, hvor der førhen ikke har været den objektorienteret tilgang, hvilket gjorde det usikkert i forhold til exception handling.
% Exception handlingen har gjort det væsentligt mere sikkert, i forhold til at medarbejderen som planlægger hvad PLC´en skal gøre, har mulighed for at tage sikkerhedsforanstaltninger med hensyn til hvad maskinen skal gøre hvis den oplever en fejl.
% Ved at forudse og behandle eventuelle fejl, kan man på den måde altid få maskinen til at lukke helt ned, med en finally-block i try/catch.